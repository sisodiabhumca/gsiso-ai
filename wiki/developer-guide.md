# Developer Guide

## Welcome Developers!

This guide is for developers who want to contribute to Gsiso AI Linux. Whether you're interested in building the system, creating packages, or contributing code, this guide will help you get started.

## Getting Started

### Prerequisites

#### System Requirements
- **OS**: Linux (Ubuntu 22.04+ recommended)
- **RAM**: 8GB+ (16GB recommended for building)
- **Storage**: 50GB+ free space
- **CPU**: Multi-core processor
- **Internet**: Stable connection for downloads

#### Required Software
```bash
# Install essential build tools
sudo apt update
sudo apt install -y \
    git \
    docker \
    build-essential \
    curl \
    wget \
    unzip \
    python3 \
    python3-pip

# Install Docker (if not already installed)
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER
```

### Repository Setup

#### Clone the Repository
```bash
# Clone the main repository
git clone https://github.com/sisodiabhumca/gsiso-ai.git
cd gsiso-ai

# Check out the latest version
git checkout main
git pull origin main
```

#### Repository Structure
```
gsiso-ai/
├── iso/                    # ISO building scripts
│   ├── build.sh           # Main build orchestrator
│   ├── build_real.sh      # Real bootable ISO builder
│   ├── build_fallback.sh  # Fallback ISO builder
│   └── build_config       # Build configuration
├── scripts/               # System scripts
│   ├── gs-pkg            # Package manager
│   ├── gs-update         # System updater
│   ├── gsiso-init        # System initialization
│   └── create-packages.sh # Package builder
├── docker/                # Docker build environment
├── docs/                  # Documentation
├── wiki/                  # Wiki pages
├── website/               # Project website
└── .github/               # GitHub Actions workflows
```

## Building Gsiso AI Linux

### Local Build Setup

#### Method 1: Using Docker (Recommended)

```bash
# Build the Docker image
docker build -t gsiso-builder -f docker/Dockerfile .

# Run the build process
docker run --rm \
    --platform linux/amd64 \
    --privileged \
    -v $(pwd):/workspace \
    -w /workspace/iso \
    gsiso-builder \
    ./build.sh
```

#### Method 2: Direct Build (Advanced)

```bash
# Install build dependencies
sudo apt install -y \
    debootstrap \
    squashfs-tools \
    xorriso \
    grub-pc-bin \
    grub-efi-amd64-bin \
    genisoimage \
    mtools \
    dosfstools \
    fakeroot \
    file \
    bc \
    bison \
    cpio \
    curl \
    flex \
    gcc \
    g++ \
    git \
    libc6-dev \
    libelf-dev \
    libssl-dev \
    make \
    python3 \
    rsync \
    sudo \
    unzip \
    wget \
    xz-utils \
    zstd

# Run the build
cd iso
sudo ./build.sh
```

### Build Process Overview

#### 1. Package Building
- Creates custom packages for the distribution
- Builds package repository
- Generates package metadata

#### 2. ISO Creation
- Creates base filesystem using debootstrap
- Installs essential packages and desktop environment
- Configures system settings and users
- Creates bootable ISO with GRUB

#### 3. Validation
- Verifies ISO integrity
- Tests boot functionality
- Validates package installation

### Build Output

After successful build, you'll find:
- **ISO File**: `iso/output/gsiso-ai-1.0.0-x86_64.iso`
- **Packages**: `repo/` directory with custom packages
- **Build Logs**: Detailed logs in build directories

## Package Development

### Understanding the Package System

Gsiso AI Linux uses a custom package management system with:
- **gs-pkg**: Package manager
- **Local Repository**: Self-contained package storage
- **Package Format**: `.tar.xz` archives with metadata

### Creating Custom Packages

#### Package Structure
```
package-name/
├── usr/
│   ├── bin/              # Executable files
│   ├── lib/              # Library files
│   └── share/            # Shared data
├── etc/                  # Configuration files
├── var/                  # Variable data
└── .PKGINFO             # Package metadata
```

#### Package Metadata (.PKGINFO)
```ini
# Generated by Gsiso AI Linux Package Builder
pkgname = package-name
pkgver = 1.0.0
pkgdesc = Package description
url = https://github.com/sisodiabhumca/gsiso-ai
builddate = 1640995200
packager = Developer Name
size = 1024000
arch = x86_64
license = GPL
depend = dependency1 dependency2
```

#### Building a Package

```bash
# Use the package builder
sudo ./scripts/create-packages.sh

# Or create manually
mkdir -p package-dir/usr/bin
cp your-script package-dir/usr/bin/
chmod +x package-dir/usr/bin/your-script

# Create metadata
cat > package-dir/.PKGINFO << EOF
pkgname = your-package
pkgver = 1.0.0
pkgdesc = Your package description
depend = bash
EOF

# Create package archive
cd package-dir
tar -cJf ../your-package-1.0.0.tar.xz .
```

### Adding Packages to the Repository

#### 1. Create Package
Follow the package creation process above.

#### 2. Add to Repository
```bash
# Copy package to repository
cp your-package-1.0.0.tar.xz repo/

# Update package database
cd repo
echo "your-package-1.0.0.tar.xz" >> packages.db
```

#### 3. Update Package Manager
```bash
# Update package lists
sudo gs-pkg update

# Install your package
sudo gs-pkg install your-package
```

## Contributing Code

### Development Workflow

#### 1. Fork the Repository
- Go to [GitHub Repository](https://github.com/sisodiabhumca/gsiso-ai)
- Click "Fork" to create your copy

#### 2. Create Feature Branch
```bash
# Clone your fork
git clone https://github.com/yourusername/gsiso-ai.git
cd gsiso-ai

# Add upstream remote
git remote add upstream https://github.com/sisodiabhumca/gsiso-ai.git

# Create feature branch
git checkout -b feature/your-feature-name
```

#### 3. Make Changes
- Edit files as needed
- Test your changes thoroughly
- Follow coding standards

#### 4. Commit Changes
```bash
# Add changes
git add .

# Commit with descriptive message
git commit -m "Add feature: brief description of changes"

# Push to your fork
git push origin feature/your-feature-name
```

#### 5. Create Pull Request
- Go to your fork on GitHub
- Click "New Pull Request"
- Select your feature branch
- Fill in the PR template
- Submit for review

### Coding Standards

#### Shell Scripts
```bash
#!/bin/bash
# Script description
# Author: Your Name
# Date: YYYY-MM-DD

set -e  # Exit on error

# Use descriptive variable names
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VERSION="1.0.0"

# Add comments for complex logic
# Check if running as root
if [ "$(id -u)" -ne 0 ]; then
    echo "Error: This script must be run as root"
    exit 1
fi

# Use functions for reusable code
main() {
    echo "Starting process..."
    # Your code here
}

# Call main function
main "$@"
```

#### Python Scripts
```python
#!/usr/bin/env python3
"""
Script description.
Author: Your Name
Date: YYYY-MM-DD
"""

import sys
import os
from typing import List, Optional


def main() -> int:
    """Main function."""
    try:
        # Your code here
        return 0
    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        return 1


if __name__ == "__main__":
    sys.exit(main())
```

### Testing Your Changes

#### Local Testing
```bash
# Test build process
./test-iso-build.sh

# Test package creation
sudo ./scripts/create-packages.sh

# Test individual components
sudo ./scripts/gs-pkg --help
sudo ./scripts/gs-update --help
```

#### Docker Testing
```bash
# Test in clean environment
docker run --rm -it gsiso-builder bash

# Test specific components
docker run --rm gsiso-builder ./scripts/gs-pkg --help
```

## System Components

### Core Scripts

#### gs-pkg (Package Manager)
- **Location**: `scripts/gs-pkg`
- **Purpose**: Install, remove, and manage packages
- **Key Functions**:
  - Package installation/removal
  - Dependency resolution
  - Package search and listing
  - Repository management

#### gs-update (System Updater)
- **Location**: `scripts/gs-update`
- **Purpose**: Update system packages and components
- **Key Functions**:
  - System package updates
  - Security updates
  - Kernel updates
  - System maintenance

#### gsiso-init (System Initialization)
- **Location**: `scripts/gsiso-init`
- **Purpose**: Initialize system on first boot
- **Key Functions**:
  - User creation and configuration
  - Network setup
  - Service configuration
  - System customization

### Build Scripts

#### build.sh (Main Build Orchestrator)
- **Location**: `iso/build.sh`
- **Purpose**: Coordinate the entire build process
- **Key Functions**:
  - Package building
  - ISO creation
  - Error handling
  - Build validation

#### build_real.sh (Real ISO Builder)
- **Location**: `iso/build_real.sh`
- **Purpose**: Create actual bootable ISO
- **Key Functions**:
  - Base filesystem creation
  - Package installation
  - System configuration
  - ISO generation

#### build_fallback.sh (Fallback Builder)
- **Location**: `iso/build_fallback.sh`
- **Purpose**: Create simple ISO when main build fails
- **Key Functions**:
  - Basic ISO creation
  - Project file packaging
  - Error recovery

## CI/CD Pipeline

### GitHub Actions

#### Build Workflow
- **File**: `.github/workflows/build-iso.yml`
- **Triggers**: Push to main, releases, manual
- **Steps**:
  1. Checkout code
  2. Build Docker image
  3. Create ISO
  4. Validate output
  5. Upload artifacts

#### CI/CD Workflow
- **File**: `.github/workflows/ci-cd.yml`
- **Triggers**: Push to main
- **Steps**:
  1. Build website
  2. Run tests
  3. Deploy to GitHub Pages

### Local CI Testing

```bash
# Test GitHub Actions locally
act -j build-iso

# Test specific workflow
act push -W .github/workflows/build-iso.yml
```

## Documentation

### Writing Documentation

#### Wiki Pages
- Use clear, concise language
- Include code examples
- Add screenshots when helpful
- Keep information up to date

#### Code Comments
```bash
# Good comment example
# Check if user has sufficient permissions to install packages
if [ "$(id -u)" -ne 0 ]; then
    echo "Error: Root privileges required"
    exit 1
fi
```

#### README Files
- Include project overview
- Installation instructions
- Usage examples
- Contributing guidelines

### Documentation Structure

```
docs/
├── installation.md       # Installation guide
├── user-guide.md        # User manual
├── developer-guide.md   # This guide
├── api-reference.md     # API documentation
└── troubleshooting.md   # Common issues
```

## Testing and Quality Assurance

### Testing Strategy

#### Unit Testing
```bash
# Test individual functions
./test/unit/test-gs-pkg.sh
./test/unit/test-gs-update.sh
```

#### Integration Testing
```bash
# Test complete workflows
./test/integration/test-build-process.sh
./test/integration/test-package-installation.sh
```

#### System Testing
```bash
# Test full system
./test/system/test-iso-boot.sh
./test/system/test-desktop-environment.sh
```

### Quality Checks

#### Code Quality
```bash
# Shell script linting
shellcheck scripts/*.sh

# Python linting
flake8 python-scripts/
pylint python-scripts/
```

#### Security Scanning
```bash
# Dependency scanning
safety check

# Container scanning
docker scan gsiso-builder
```

## Release Process

### Version Management

#### Semantic Versioning
- **Major**: Breaking changes (1.0.0 → 2.0.0)
- **Minor**: New features (1.0.0 → 1.1.0)
- **Patch**: Bug fixes (1.0.0 → 1.0.1)

#### Release Checklist
- [ ] Update version numbers
- [ ] Update changelog
- [ ] Test build process
- [ ] Create release tag
- [ ] Build and test ISO
- [ ] Update documentation
- [ ] Announce release

### Creating a Release

```bash
# Update version
sed -i 's/VERSION="1.0.0"/VERSION="1.1.0"/' iso/build_real.sh

# Create release branch
git checkout -b release/v1.1.0

# Commit changes
git add .
git commit -m "Release v1.1.0"

# Create tag
git tag -a v1.1.0 -m "Release v1.1.0"

# Push changes
git push origin release/v1.1.0
git push origin v1.1.0
```

## Community Guidelines

### Contributing Guidelines

#### Before Contributing
1. **Check Issues**: Look for existing issues or discussions
2. **Discuss Changes**: Open an issue for major changes
3. **Follow Standards**: Adhere to coding and documentation standards
4. **Test Thoroughly**: Ensure your changes work correctly

#### Pull Request Guidelines
- **Clear Description**: Explain what and why, not how
- **Include Tests**: Add tests for new functionality
- **Update Documentation**: Keep docs current with changes
- **Follow Templates**: Use provided PR templates

### Communication

#### GitHub Discussions
- **General Questions**: Use Discussions for questions
- **Feature Requests**: Discuss before implementing
- **Bug Reports**: Use Issues for bugs
- **Help Requests**: Ask for help in Discussions

#### Code of Conduct
- **Be Respectful**: Treat others with respect
- **Be Inclusive**: Welcome diverse contributions
- **Be Constructive**: Provide helpful feedback
- **Be Patient**: Allow time for review and discussion

## Getting Help

### Resources

#### Documentation
- **Wiki**: [Project Wiki](https://github.com/sisodiabhumca/gsiso-ai/wiki)
- **README**: [Main README](https://github.com/sisodiabhumca/gsiso-ai/blob/main/README.md)
- **Installation Guide**: [Installation Guide](installation-guide.md)
- **User Guide**: [User Guide](user-guide.md)

#### Community
- **Issues**: [GitHub Issues](https://github.com/sisodiabhumca/gsiso-ai/issues)
- **Discussions**: [GitHub Discussions](https://github.com/sisodiabhumca/gsiso-ai/discussions)
- **Repository**: [GitHub Repository](https://github.com/sisodiabhumca/gsiso-ai)

#### External Resources
- **Linux Documentation**: [Linux Documentation Project](https://tldp.org/)
- **Shell Scripting**: [Bash Guide](https://mywiki.wooledge.org/BashGuide)
- **Docker Documentation**: [Docker Docs](https://docs.docker.com/)

### Common Issues

#### Build Failures
- **Check Dependencies**: Ensure all required packages are installed
- **Check Permissions**: Verify you have necessary permissions
- **Check Logs**: Review build logs for specific errors
- **Check Resources**: Ensure sufficient disk space and memory

#### Package Issues
- **Check Metadata**: Verify package metadata is correct
- **Check Dependencies**: Ensure all dependencies are available
- **Check Permissions**: Verify file permissions are correct
- **Test Installation**: Test package installation process

## Conclusion

Thank you for your interest in contributing to Gsiso AI Linux! This guide should help you get started with development and contribution.

### Next Steps

1. **Set Up Environment**: Follow the setup instructions
2. **Explore Codebase**: Familiarize yourself with the project structure
3. **Start Small**: Begin with simple contributions
4. **Join Community**: Participate in discussions and issues
5. **Build Something**: Create packages or improve existing components

### Additional Resources

- **Installation Guide**: [Installation Guide](installation-guide.md)
- **User Guide**: [User Guide](user-guide.md)
- **FAQ**: [Frequently Asked Questions](faq.md)
- **Project Home**: [GitHub Repository](https://github.com/sisodiabhumca/gsiso-ai)

---

**Happy coding!** 🐧💻✨ 